schema: |-
  entity user {}

  entity organization {

      // organizational roles
      relation admin @user
      relation member @user

  }

  entity repository {

      // represents repositories parent organization
      relation parent @organization

      // represents owner of this repository
      relation owner  @user

      // permissions
      permission edit   = parent.admin or owner
      permission delete = owner
  }

relationships:
  - organization:6574#admin@user:5678
  - repository:1234#parent@organization:6574

attributes:

scenarios:
  - name: admin_access_test
    description: "Verifies admin user can edit but not delete a repository they don't own."
    checks:
      - entity: repository:1234
        subject: user:5678
        context: null
        assertions:
          edit: true
          delete: false
      - entity: repository:91011
        subject: user:1213
        context: null
        assertions:
          edit: false
          delete: false
    entity_filters: []
    subject_filters: []
  - name: owner_access_test
    description: "Verifies repository owner has full permissions using scenario-specific relationships."
    relationships:
      - "repository:1234#owner@user:9999"
    checks:
      - entity: repository:1234
        subject: user:9999
        assertions:
          edit: true
          delete: true
