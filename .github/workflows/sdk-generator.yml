name: Generate Client SDKs from OpenAPI

on:
  release:
    types: [published]
    workflow_dispatch:

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - name: Harden Runner
              uses: step-security/harden-runner@f4a75cfd619ee5ce8d5b864b0d183aff3c69b55a # v2.13.1
              with:
                egress-policy: audit

            - name: Checkout repository
              uses: actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8 # v5.0.0

            - name: Invoke generator workflow Permify/permify-java repo
              uses: benc-uk/workflow-dispatch@e2e5e9a103e331dad343f381a29e654aea3cf8fc # v1.2.4
              with:
                workflow: generator.yml
                repo: Permify/permify-java
                ref: master
                token: "${{ secrets.SDK_GH_TOKEN }}"
        
            - name: Invoke generator workflow Permify/permify-python repo
              uses: benc-uk/workflow-dispatch@e2e5e9a103e331dad343f381a29e654aea3cf8fc # v1.2.4
              with:
                workflow: generator.yml
                repo: Permify/permify-python
                ref: main
                token: "${{ secrets.SDK_GH_TOKEN }}"
